{% extends "layout.html" %}

{% block content %}
<h1 class="text-center">
	SS13 Global Stats
</h1>
<div class="text-center">
	<span class="badge badge-primary font-size-18 m-5"><span id="data_points_stat">...</span> Data Points</span>
	<span class="badge badge-primary font-size-18 m-5"><span id="unique_servers_stat">...</span> Unique Servers</span>
	<span class="badge badge-primary font-size-18 m-5"><span id="online_players_stat">...</span> Online Players</span>

	<script>
		function update_summary_stats() {
			$.getJSON("/api/summary", function(data) {
				$("#data_points_stat").text(data.data_point_count.toLocaleString("en-US"));
				$("#unique_servers_stat").text(data.server_count.toLocaleString("en-US"));
				$("#online_players_stat").text(data.player_count.toLocaleString("en-US"));
			})
		}

		setInterval(update_summary_stats, 1000 * 600);
		update_summary_stats();
	</script>
</div>

<br/>

<div class="text-center">
	<div class="btn-group" role="group" aria-label="Basic example">
		<button id="button-time-window-DAY" class="btn btn-primary" type="button" onClick="set_time_window('DAY');">Day</button>
		<button id="button-time-window-WEEK" class="btn" type="button" onClick="set_time_window('WEEK');">Week</button>
		<button id="button-time-window-MONTH" class="btn" type="button" onClick="set_time_window('MONTH');">Month</button>
		<button id="button-time-window-YEAR" class="btn" type="button" onClick="set_time_window('YEAR');">Year</button>
		<button id="button-time-window-ALL" class="btn" type="button" onClick="set_time_window('ALL');">All Time</button>
	</div>
</div>


<div class="card">
	<h2 class="card-title text-center">Global Player Count</h2>
	<canvas id="global_player_count_chart" height="80px"></canvas>
</div>

<div class="card">
	<h2 class="card-title text-center">Global Server Count</h2>
	<canvas id="global_server_count_chart" height="80px"></canvas>
</div>

<div class="card">
	<h2 class="card-title text-center">Byond Fan Count</h2>
	<canvas id="byond_fan_count_chart" height="80px"></canvas>
</div>

<script>
	new SS13StatsChart(
		"global_player_count_chart",
		"Global Player Count",
		"/api/global_stats?type=PLAYER_COUNT"
	)

	new SS13StatsChart(
		"global_server_count_chart",
		"Global Server Count",
		"/api/global_stats?type=SERVER_COUNT"
	)

	new SS13StatsChart(
		"byond_fan_count_chart",
		"Byond Fan Count",
		"/api/global_stats?type=FAN_COUNT"
	)
</script>

{% endblock %}

